---
import BaseLayout from '../../../../layouts/BaseLayout.astro';
import BaseTagsIndex, { getTagsIndexTranslations } from '../../../../components/pages/BaseTagsIndex.astro';
import { getCollection } from 'astro:content';
import type { SupportedLanguage } from '../../../../types/i18n';

const pageTitle = 'Argomenti';

// Set language to Italian for this page
const language: SupportedLanguage = 'it';

// Get translations for Italian
const t = getTagsIndexTranslations(language);

// Page description for SEO and social sharing
const pageDescription = t.pageDescription;

// Get all posts and filter by Italian language
const allPosts = await getCollection('blog');
const localizedPosts = allPosts.filter((post) => post.slug.startsWith(language + '/'));
const tags = [...new Set(localizedPosts.map((post) => post.data.tags).flat())] as string[];
tags.sort();

// Set language info for BaseLayout
const i18nData = {
    currentLang: language,
};

export const prerender = true;
---

<BaseLayout pageTitle={pageTitle} description={pageDescription} i18nData={i18nData}>
    <BaseTagsIndex language={language} tags={tags} />
</BaseLayout>
