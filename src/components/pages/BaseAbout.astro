---
import { Image } from 'astro:assets';
import TwitterFeed from '../TwitterFeed.astro';
import profilePic from '../../assets/alepro.png';
import { getTwitterFeedData } from '../../utils/twitter/twitter-feed';
import { getAboutTranslations } from '../../utils/translations';
import type { SupportedLanguage } from '../../types/i18n';

interface Props {
    language: SupportedLanguage;
}

const { language } = Astro.props;

// Get translations for the current language
const t = getAboutTranslations(language);

// Fetch Twitter data server-side for live updates
const twitterData = await getTwitterFeedData();
---

<h2>{t.tagline}</h2>

<div class="intro">
    <div class="content">
        <p>
            {t.intro1}
        </p>

        <p>
            {t.intro2}
            <span class="mollie-logo-wrapper">
                <img src="/Mollie-Logo-Black-2023.svg" class="mollie-logo light-logo" alt="Mollie" />
                <img src="/Mollie-Logo-White-2023.svg" class="mollie-logo dark-logo" alt="Mollie" />
            </span>.
        </p>
        <p>
            {t.intro3}
        </p>
        <p>
            {t.stayUpdated}
            <a href="https://x.com/intent/user?screen_name=_aleromano" target="_blank" rel="noopener noreferrer"
                >{t.followTwitter}</a
            > or <a href="/rss.xml">{t.subscribeRss}</a>
        </p>
        <p>
            {t.needHelp}
            <a href={language === 'it' ? '/it/contact' : '/contact'}>{t.letsTalk}</a>
        </p>
    </div>
    <Image src={profilePic} alt={t.profilePicAlt} width={300} densities={[1, 2]} quality="max" class="profile-pic" />
</div>

<TwitterFeed
    posts={twitterData.posts}
    error={twitterData.error}
    language={language}
    freshness={twitterData.freshness}
/>

<style>
    .intro {
        display: flex;
        align-items: center;
        gap: var(--space-md);
        margin: var(--space-lg) 0 0;
    }

    .content {
        flex: 1;
    }

    .mollie-logo-wrapper {
        display: inline-block;
    }

    .mollie-logo {
        height: 1rem;
    }

    /* Show/hide based on theme */
    .dark-logo {
        display: none;
    }

    :global([data-theme='dark']) .dark-logo {
        display: inline;
    }

    :global([data-theme='dark']) .light-logo {
        display: none;
    }

    .profile-pic {
        margin-bottom: calc(-1 * var(--space-lg));
        max-width: 100%;
        height: auto;
        transform: translateY(0);
        animation: slideDown 1s ease-out 0.2s backwards;
    }

    @keyframes slideDown {
        from {
            transform: translateY(-25%);
        }
        to {
            transform: translateY(0);
        }
    }

    @media (max-width: 636px) {
        .intro {
            flex-direction: column;
        }

        .profile-pic {
            margin-bottom: -1.2rem;
        }
    }
</style>
