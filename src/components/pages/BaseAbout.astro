---
import { Image } from 'astro:assets';
import TwitterFeed from '../TwitterFeed.astro';
import profilePic from '../../assets/alepro.png';
import { getTwitterFeedData } from '../../utils/twitter/twitter-feed';
import type { SupportedLanguage } from '../../types/i18n';

export interface AboutTranslations {
    pageTitle: string;
    pageDescription: string;
    tagline: string;
    intro1: string;
    intro2: string;
    intro3: string;
    stayUpdated: string;
    followTwitter: string;
    subscribeRss: string;
    needHelp: string;
    letsTalk: string;
    profilePicAlt: string;
}

export const aboutTranslations: Record<SupportedLanguage, AboutTranslations> = {
    en: {
        pageTitle: 'About',
        pageDescription:
            'Engineering Manager at Mollie, father of two amazing kids, and funny lovely husband. Addicted to details and obsessed with how things work: from Cloud services to human relationships.',
        tagline: 'Insightful. Precise. Human.',
        intro1: "I'm addicted to details and obsessed with how things work: from Cloud services to human relationships. Since my first Hello World in RPG Maker, I have come to believe that being an Engineer is much more than coding.",
        intro2: "I'm currently an Engineering Manager at Mollie, where I focus on helping teams collaborate effectively and deliver impactful solutions.",
        intro3: "When I'm not fostering great engineering culture, you can find me in Busto Arsizio (near Milan's Malpensa airport) where I'm a proud father of two amazing kids and a funny lovely husband.",
        stayUpdated: 'Wanna stay updated?',
        followTwitter: 'Follow @_aleromano',
        subscribeRss: 'subscribe to my RSS feed.',
        needHelp: 'Need help launching your startup, scaling your engineering team, or growing as a software engineer?',
        letsTalk: "Let's talk.",
        profilePicAlt: 'Alessandro Romano profile picture',
    },
    it: {
        pageTitle: 'Chi Sono',
        pageDescription:
            'Engineering Manager a Mollie, padre di due bambini fantastici e marito divertente e affettuoso. Ossessionato dai dettagli e da come funzionano le cose: dai servizi Cloud alle relazioni umane.',
        tagline: 'Perspicace. Preciso. Umano.',
        intro1: 'Sono ossessionato dai dettagli e da come funzionano le cose: dai servizi Cloud alle relazioni umane. Dal mio primo Hello World in RPG Maker, sono arrivato a credere che essere un Ingegnere sia molto pi√π che programmare.',
        intro2: "Attualmente sono Engineering Manager a Mollie, dove mi concentro sull'aiutare i team a collaborare efficacemente e fornire soluzioni di impatto.",
        intro3: "Quando non sto promuovendo un'ottima cultura ingegneristica, mi trovi a Busto Arsizio (vicino all'aeroporto di Milano Malpensa) dove sono un orgoglioso padre di due bambini fantastici e un marito divertente e affettuoso.",
        stayUpdated: 'Vuoi rimanere aggiornato?',
        followTwitter: 'Segui @_aleromano',
        subscribeRss: 'iscriviti al mio feed RSS.',
        needHelp:
            'Hai bisogno di aiuto per lanciare la tua startup, far crescere il tuo team di ingegneria, o crescere come ingegnere del software?',
        letsTalk: 'Parliamone.',
        profilePicAlt: 'Foto profilo di Alessandro Romano',
    },
};

export function getAboutTranslations(language: SupportedLanguage): AboutTranslations {
    return aboutTranslations[language];
}

interface Props {
    language: SupportedLanguage;
}

const { language } = Astro.props;

// Get translations for the current language
const t = getAboutTranslations(language);

// Fetch Twitter data server-side for live updates
const twitterData = await getTwitterFeedData();
---

<h2>
    {t.tagline}
</h2>

<div class="intro">
    <div class="content">
        <p>
            {t.intro1}
        </p>

        <p>
            {t.intro2}
            <span class="mollie-logo-wrapper">
                <img src="/Mollie-Logo-Black-2023.svg" class="mollie-logo light-logo" alt="Mollie" />
                <img src="/Mollie-Logo-White-2023.svg" class="mollie-logo dark-logo" alt="Mollie" />
            </span>.
        </p>
        <p>
            {t.intro3}
        </p>
        <p>
            {t.stayUpdated}
            <a href="https://x.com/intent/user?screen_name=_aleromano" target="_blank" rel="noopener noreferrer"
                >{t.followTwitter}</a
            > or <a href="/rss.xml">{t.subscribeRss}</a>
        </p>
        <p>
            {t.needHelp}
            <a href={language === 'it' ? '/it/contact' : '/contact'}>{t.letsTalk}</a>
        </p>
    </div>
    <Image
        src={profilePic}
        alt={t.profilePicAlt}
        width={300}
        priority
        densities={[1, 2]}
        quality="max"
        class="profile-pic"
    />
</div>

<TwitterFeed
    posts={twitterData.posts}
    error={twitterData.error}
    language={language}
    freshness={twitterData.freshness}
/>

<style>
    .intro {
        display: flex;
        align-items: center;
        gap: var(--space-md);
        margin: var(--space-lg) 0 0;
    }

    .content {
        flex: 1;
    }

    .mollie-logo-wrapper {
        display: inline-block;
    }

    .mollie-logo {
        height: 1rem;
    }

    /* Show/hide based on theme */
    .dark-logo {
        display: none;
    }

    :global([data-theme='dark']) .dark-logo {
        display: inline;
    }

    :global([data-theme='dark']) .light-logo {
        display: none;
    }

    .profile-pic {
        margin-bottom: calc(-1 * var(--space-lg));
        max-width: 100%;
        height: auto;
        transform: translateY(0);
        animation: slideDown 1s ease-out 0.2s backwards;
    }

    @keyframes slideDown {
        from {
            transform: translateY(-25%);
        }
        to {
            transform: translateY(0);
        }
    }

    @media (max-width: 636px) {
        .intro {
            flex-direction: column;
        }

        .profile-pic {
            margin-bottom: -1.2rem;
        }
    }
</style>
